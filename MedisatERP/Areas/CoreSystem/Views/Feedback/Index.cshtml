@using DevExtreme.AspNet.Mvc
@using MedisatERP.Areas.CoreSystem.Models
@model MedisatERP.Areas.CoreSystem.Views.IndexModel

@{
    Layout = "_Layout";
    ViewData["Title"] = "Customer Feedback";
}

<style>
    .lbl_header {
        margin-bottom: 10px;
        margin-top: 10px;
    }

    .company-logo {
        max-width: 100px;
        max-height: 100px;
    }

    /* Add padding to the grid container */
    #feedbackGrid {
        padding: 20px; /* Adds 20px padding around the grid */
    }
</style>

<!-- Section Title Card -->
<div class="card col-12 text-white" style="margin-bottom:20px;padding:20px;background: linear-gradient(to top, #6f42c1, #9b6bd3);">
    <center><span><i data-feather="users"></i> CUSTOMER FEEDBACK</span></center>
</div>

<!-- DevExtreme DataGrid for Feedbacks -->
<div id="feedbackGrid">
    @(Html.DevExtreme().DataGrid<Feedback>()
        .ShowBorders(true)
        .ID("gv_feedbackList")
        .DataSource(d => d.Mvc().Controller("FeedbacksAPI").LoadAction("Get").Key("FeedbackId")
        .InsertAction("Post")
        .UpdateAction("Put")
        .DeleteAction("Delete"))
        .ShowColumnLines(false)
        .ShowRowLines(true)
        .RowAlternationEnabled(true)
        .ColumnHidingEnabled(true)
        .ColumnAutoWidth(true)
        .Selection(s => s.Mode(SelectionMode.Multiple))
        .SearchPanel(s => s.Visible(true).Width(250).Placeholder("Search..."))
        .FocusedRowEnabled(true)
        .Paging(p => p.PageSize(10))
        .RemoteOperations(true)
        .Summary(s => s.TotalItems(totalItems => { totalItems.AddFor(m => m.FeedbackId).SummaryType(SummaryType.Count);}))
        .Editing(e => e
        .AllowAdding(false)  // Disable adding new feedback
        .AllowUpdating(true)  // Allow editing feedback
        .AllowDeleting(true)  // Allow deleting feedback
        .Mode(GridEditMode.Popup)
        .Popup(p => p
        .Title("Customer Feedback")
        .Height(450)
        .ShowTitle(true)
        .Position(pos => pos
        .My(HorizontalAlignment.Center, VerticalAlignment.Center)
        .At(HorizontalAlignment.Center, VerticalAlignment.Center)
        .Of(new JS("window"))
        )
        )
        )
        .Sorting(s => s
        .Mode(GridSortingMode.Multiple)  // Allows sorting by multiple columns
        )
        .Columns(columns =>
        {
            columns.AddFor(m => m.FeedbackId).Visible(false); // Hide the FeedbackId column
            columns.AddFor(m => m.UserId).Caption("User ID");
            columns.AddFor(m => m.FeedbackText).Caption("Feedback");
            columns.AddFor(m => m.Rating).Caption("Rating");
            columns.AddFor(m => m.Category).Caption("Category");
            columns.AddFor(m => m.SubmittedAt).Caption("Submitted At").Format("MM/dd/yyyy");
            columns.AddFor(m => m.Resolved).Caption("Resolved").DataType(GridColumnDataType.Boolean);
        })
        )
</div>
