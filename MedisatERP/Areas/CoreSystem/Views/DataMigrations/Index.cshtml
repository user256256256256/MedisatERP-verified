@using DevExtreme.AspNet.Mvc
@using MedisatERP.Areas.CoreSystem.Models
@model MedisatERP.Areas.CoreSystem.Views.IndexModel

@{
    Layout = "_Layout";
    ViewData["Title"] = "System Migrations";
}

<style>
    .lbl_header {
        margin-bottom: 10px;
        margin-top: 10px;
    }

    .company-logo {
        max-width: 100px;
        max-height: 100px;
    }

    /* Add padding to the grid container */
    #migrationGrid {
        padding: 20px;
    }
</style>

<!-- Section Title Card -->
<div class="card col-12 text-white" style="margin-bottom:20px;padding:20px;background: linear-gradient(to top, #6f42c1, #9b6bd3);">
    <center><span><i data-feather="users"></i> SYSTEM MIGRATIONS</span></center>
</div>

<!-- DevExtreme DataGrid for System Migrations -->
<div id="migrationGrid">
    @(
        Html.DevExtreme().DataGrid<DataMigration>()
            .ShowBorders(true)
            .ID("gv_migrationList")
            .DataSource(d => d.Mvc().Controller("DataMigrationsAPI").LoadAction("Get").Key("MigrationId")
            .InsertAction("Post")
            .UpdateAction("Put")
            .DeleteAction("Delete"))
            .ShowColumnLines(false)
            .ShowRowLines(true)
            .RowAlternationEnabled(true)
            .ColumnHidingEnabled(true)
            .ColumnAutoWidth(true)
            .Selection(s => s.Mode(SelectionMode.Multiple))
            .SearchPanel(s => s.Visible(true).Width(250).Placeholder("Search..."))
            .FocusedRowEnabled(true)
            .Paging(p => p.PageSize(10))
            .RemoteOperations(true)
            .Summary(s => s.TotalItems(totalItems => { totalItems.AddFor(m => m.MigrationId).SummaryType(SummaryType.Count);}))
            .Editing(e => e
        .AllowAdding(false)  
        .AllowUpdating(false)  
        .AllowDeleting(true)  
        .Mode(GridEditMode.Popup)
        .Popup(p => p
        .Title("System Migration")
        .Height(450)
        .ShowTitle(true)
        .Position(pos => pos
        .My(HorizontalAlignment.Center, VerticalAlignment.Center)
        .At(HorizontalAlignment.Center, VerticalAlignment.Center)
        .Of(new JS("window"))
        )
        )
        )

        .Columns(columns =>
        {
            columns.AddFor(m => m.MigrationId).Visible(false);  // Hide MigrationId
            columns.AddFor(m => m.SourceSystem).Caption("Source System");
            columns.AddFor(m => m.DestinationSystem).Caption("Destination System");
            columns.AddFor(m => m.Status).Caption("Status");
            columns.AddFor(m => m.StartDate).Caption("Start Date").DataType(GridColumnDataType.Date).Format("MM/dd/yyyy");
            columns.AddFor(m => m.EndDate).Caption("End Date").DataType(GridColumnDataType.Date).Format("MM/dd/yyyy");
            columns.AddFor(m => m.RecordsMigrated).Caption("Records Migrated");
            columns.AddFor(m => m.ErrorCount).Caption("Error Count");
            columns.AddFor(m => m.Log).Caption("Log").Visible(false); // You can choose whether to display this field or not
            columns.AddFor(m => m.MappingRules).Caption("Mapping Rules");
        })
        )

</div>
